$NetBSD: patch-ae,v 1.3 2024/01/30 09:04:41 wiz Exp $

- Include missing header
- Use AUDIO_INITINFO for parameter initialization

--- src/audio/au_sun.c.orig	2020-08-13 00:17:09.000000000 +0000
+++ src/audio/au_sun.c
@@ -45,6 +45,7 @@
 #include <sys/stat.h>
 #include <fcntl.h>
 #include <errno.h>
+#include <sys/ioctl.h>
 #include <sys/filio.h>
 #include <sys/audioio.h>
 #include "cst_string.h"
@@ -76,7 +77,7 @@ cst_audiodev *audio_open_sun(int sps, in
 	    cst_error();
 	}
     }
-    ioctl(fd,AUDIO_GETINFO,&ainfo);
+    AUDIO_INITINFO(&ainfo);
 
     switch (fmt)
     {
@@ -163,7 +164,7 @@ int audio_write_sun(cst_audiodev *ad, vo
 
 int audio_flush_sun(cst_audiodev *ad)
 {
-    return ioctl((int)ad->platform_data, AUDIO_DRAIN, 0);
+    return ioctl((int)ad->platform_data, AUDIO_FLUSH, 0);
 }
 
 /* FIXME... */
